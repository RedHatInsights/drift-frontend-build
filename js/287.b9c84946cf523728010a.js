(self.webpackChunkdrift_frontend=self.webpackChunkdrift_frontend||[]).push([[287],{89287:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DriftPage:()=>Ie,default:()=>Ee});var r=n(92137),a=n(6610),s=n(5991),o=n(10379),i=n(86089),c=n(77608),l=n(87757),u=n.n(l),d=n(25558),f=n.n(d),p=n(45697),m=n.n(p),h=n(334),y=n(45237),S=n(84817),v=n(37020),g=n(54446),b=n(48270),I=n(56077),E=n(59386),F=n(83068),P=n(85061),C=n(17563),R=n(99373);function k(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],i=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,d=[].concat((0,P.Z)(o),(0,P.Z)(i&&!o.includes(i)?[i]:[])),f=(0,P.Z)((null==c||null===(t=c.filter((function(e){return e.selected})))||void 0===t?void 0:t.map((function(e){var t=e.filter;return null==t?void 0:t.toLowerCase()})))||[]),p=[].concat((0,P.Z)([R.aW,R.jo].includes(u)?["".concat(u===R.jo?"-":"","state")]:[]),(0,P.Z)([R.aW,R.jo].includes(l)?["".concat(l===R.jo?"-":"","fact")]:[])),m="?";e.push({search:m+C.stringify({system_ids:n,baseline_ids:r,hsp_ids:a,reference_id:s})}),m="&",n.length||r.length||a.length||s||(m=""),e.push({search:e.location.search+m+C.stringify({"filter[name]":d,"filter[state]":f,sort:p},{arrayFormat:"comma",encode:!1})})}var w=n(96156),x=n(28481),B=n(63349),T=n(31095),H=n(69269),Z=n(34869),D=n(61104),O=n(86047),A=n(30381),N=n.n(A);var M=function(e){(0,o.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var a=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function l(e){var t;return(0,a.Z)(this,l),(t=r.call(this,e)).handleChange=function(){var e=t.props,n=e.findType,r=e.id,a=e.type,s=t.state.isChecked;n(a,r),t.setState({isChecked:!s})},t.state={isChecked:!0},t}return(0,s.Z)(l,[{key:"render",value:function(){var e=this.state.isChecked;return f().createElement(f().Fragment,null,f().createElement(v.Checkbox,{isChecked:e,onChange:this.handleChange,"aria-label":"controlled checkbox example",id:"check-1",name:"check1"}))}}]),l}(d.Component);M.propTypes={type:m().string,findType:m().func,id:m().string};const _=M;var j=function(e){(0,o.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var a=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function l(e){var t;return(0,a.Z)(this,l),(t=r.call(this,e)).buildRows=function(){var e=t.props,n=e.entities,r=e.findType,a=e.selectedBaselineContent,s=e.selectedHSPContent,o=e.selectedSystemContent,i=e.handleDeselect,c=[];return a.forEach((function(e){c.push(f().createElement("tr",null,f().createElement("td",null,f().createElement(_,{type:"baseline",findType:r,id:e.id,handleDeselect:i})),f().createElement("td",null,e.icon),f().createElement("td",{style:{"align-content":"left"}},e.name)))})),o.forEach((function(e){c.push(f().createElement("tr",null,f().createElement("td",null,f().createElement(_,{type:"system",findType:r,id:e.id,handleDeselect:i})),f().createElement("td",null,e.icon),f().createElement("td",{style:{"align-content":"left"}},e.name))),null==s||s.forEach((function(t){t.system_id===e.id&&c.push(f().createElement("tr",null,f().createElement("td",null,f().createElement(_,{type:"hsp",findType:r,id:t.id,handleDeselect:i})),f().createElement("td",null,t.icon),f().createElement("td",{style:{"align-content":"left"}},f().createElement("div",null,e.name),f().createElement("div",null,N().utc(t.captured_date).format("DD MMM YYYY, HH:mm UTC")))))}))})),null==s||s.forEach((function(e){var t;null!=n&&null!==(t=n.selectedSystemIds)&&void 0!==t&&t.includes(e.system_id)||c.push(f().createElement("tr",null,f().createElement("td",null,f().createElement(_,{type:"hsp",findType:r,id:e.id,handleDeselect:i})),f().createElement("td",null,e.icon),f().createElement("td",{style:{"align-content":"left"}},f().createElement("div",null,e.system_name),f().createElement("div",null,N().utc(e.captured_date).format("DD MMM YYYY, HH:mm UTC")))))})),c},t}return(0,s.Z)(l,[{key:"render",value:function(){return f().createElement(f().Fragment,null,f().createElement("table",{className:"pf-c-table"},f().createElement("tbody",null,this.buildRows())))}}]),l}(d.Component);j.propTypes={selectedBaselineContent:m().array,entities:m().object,selectedHSPContent:m().array,selectedSystemContent:m().array,findType:m().func,handleDeselect:m().func};const V=j;var L=function(e){(0,o.Z)(d,e);var t,n,l=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var a=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function d(e){var t;return(0,a.Z)(this,d),(t=l.call(this,e)).onToggle=(0,r.Z)(u().mark((function e(){var n,a,s,o,i,c,l,d,f,p,m,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.state,a=n.baselinesToDeselect,s=n.hspsToDeselect,o=n.systemsToDeselect,i=t.props,c=i.handleBaselineSelection,l=i.handleHSPSelection,d=i.selectBaseline,f=i.selectEntity,p=i.selectHistoricProfiles,m=i.selectedBaselineContent,h=i.selectedHSPContent,(0,i.toggleBasketVisible)(),!a.length){e.next=7;break}return e.next=6,d(a,!1,"COMPARISON");case 6:c(m.filter((function(e){return a.includes(e.id)})),!1);case 7:if(!s.length){e.next=11;break}return s.forEach(function(){var e=(0,r.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(h.find((function(e){return e.id===t})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=11,p(h.filter((function(e){return!s.includes(e.id)})).map((function(e){return e.id})));case 11:o.forEach(function(){var e=(0,r.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t,!1);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.clearDeselected();case 13:case"end":return e.stop()}}),e)}))),t.findType=function(e,n){var r,a=t.state,s=a.systemsToDeselect,o=a.baselinesToDeselect,i=a.hspsToDeselect;"system"===e?(r=t.toggleSelected(s,n),t.setState({systemsToDeselect:r})):"baseline"===e?(r=t.toggleSelected(o,n),t.setState({baselinesToDeselect:r})):(r=t.toggleSelected(i,n),t.setState({hspsToDeselect:r}))},t.toggleSelected=function(e,n){var r=[];return e.includes(n)?r=t.removeId(n,e):(r=(0,P.Z)(e)).push(n),r},t.state={systemsToDeselect:[],baselinesToDeselect:[],hspsToDeselect:[]},t.clearDeselected=function(){t.setState({systemsToDeselect:[]}),t.setState({baselinesToDeselect:[]}),t.setState({hspsToDeselect:[]})},t}return(0,s.Z)(d,[{key:"removeId",value:function(e,t){var n=[];return t.forEach((function(t){e!==t&&n.push(t)})),n}},{key:"findSelected",value:function(){var e=this.props,t=e.selectedBaselineContent,n=e.selectedHSPContent,r=e.selectedSystemContent,a=0;return r.length?a+=r.length+t.length+n.length:a+=t.length+n.length,a}},{key:"render",value:function(){var e=this,t=this.props,n=t.entities,r=t.isVisible,a=t.selectedBaselineContent,s=t.selectedHSPContent,o=t.selectedSystemContent;return f().createElement(f().Fragment,null,f().createElement("span",null,f().createElement(v.Popover,{id:"selected-basket",isVisible:r,shouldClose:function(){return e.onToggle()},headerContent:f().createElement("div",null,"Selected items"),position:v.PopoverPosition.bottom,bodyContent:f().createElement("div",{style:{maxHeight:"350px",overflowY:"scroll"}},f().createElement(V,{selectedBaselineContent:a,entities:n,selectedHSPContent:s,findType:this.findType,handleDeselect:this.handleDeselect,selectedSystemContent:o}))},f().createElement("a",{onClick:function(){return e.onToggle()}},"Selected (",this.findSelected(),")"))))}}]),d}(d.Component);L.propTypes={handleBaselineSelection:m().func,handleHSPSelection:m().func,entities:m().object,isVisible:m().bool,selectBaseline:m().func,selectedBaselineContent:m().array,selectedHSPContent:m().array,selectedSystemContent:m().array,selectEntity:m().func,selectHistoricProfiles:m().func,toggleBasketVisible:m().func};const Y=L;var U=n(69078);var W=function(e){(0,o.Z)(p,e);var t,n,l,d=(n=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(n);if(l){var r=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,i.Z)(this,e)});function p(e){var t;return(0,a.Z)(this,p),(t=d.call(this,e)).toggleBasketVisible=function(){var e=t.state.basketIsVisible;(0,t.props.disableSystemTable)(!e),t.setState({basketIsVisible:!e})},t.onSelect=function(e,n,r){var a,s=t.props,o=s.baselineTableData,i=s.handleBaselineSelection,c=s.selectBaseline,l=[];-1===r?(a=o.map((function(e){return e[0]})),l=o.map((function(e){return{id:e[0],icon:f().createElement(g.BlueprintIcon,null),name:e[1]}}))):(a=[o[r][0]],l.push({id:o[r][0],icon:f().createElement(g.BlueprintIcon,null),name:o[r][1]})),c(a,n,"COMPARISON"),i(l,n)},t.onBulkSelect=function(e){var n,r=t.props,a=r.baselineTableData,s=r.handleBaselineSelection,o=r.selectBaseline,i=[];a.forEach((function(e){i.push(e[0])})),n=a.map((function(e){return{id:e[0],icon:f().createElement(g.BlueprintIcon,null),name:e[1]}})),o(i,e,"COMPARISON"),s(n,e)},t.systemContentSelect=function(e){var n=t.props,r=n.entities,a=n.handleSystemSelection,s=[];0===e.id?s=r.rows.map((function(e){return{id:e.id,name:e.display_name,icon:f().createElement(g.ServerIcon,null)}})):r.rows.forEach((function(t){t.id===e.id&&s.push({id:t.id,name:t.display_name,icon:f().createElement(g.ServerIcon,null)})})),a(s,e.selected)},t.confirmModal=t.confirmModal.bind((0,B.Z)(t)),t.cancelSelection=t.cancelSelection.bind((0,B.Z)(t)),t.changeActiveTab=t.changeActiveTab.bind((0,B.Z)(t)),t.state={columns:[{title:"Name",transforms:[T.sortable]},{title:"Last updated",transforms:[T.sortable,(0,T.cellWidth)(20)]}],basketIsVisible:!1},t}return(0,s.Z)(p,[{key:"componentDidMount",value:(t=(0,r.Z)(u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:this.props.updateColumns("display_name"),window.entityListener=(0,H.pD)({actionType:"SELECT_ENTITY",callback:function(e){var n=e.data;t.props.addSystemModalOpened&&t.systemContentSelect(n)}});case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.baselines,n=e.handleBaselineSelection,r=e.handleHSPSelection,a=e.handleSystemSelection,s=e.historicalProfiles,o=e.selectedBaselineContent,i=e.selectedHSPContent,c=e.selectedSystemContent,l=e.systems;!(t.length||s.length||l.length)||o.length||i.length||c.length||(a(l.map((function(e){return{id:e.id,icon:f().createElement(g.ServerIcon,null),name:e.display_name}})),!0),n(t.map((function(e){return{id:e.id,icon:f().createElement(g.BlueprintIcon,null),name:e.display_name}})),!0),s.forEach((function(e){var t={system_name:e.display_name,captured_date:e.updated,id:e.id,system_id:e.system_id};r(t)})))}},{key:"confirmModal",value:function(){var e=this.props,t=e.confirmModal,n=e.entities,r=e.selectedBaselineIds,a=e.toggleAddSystemModal,s=e.selectedHSPIds,o=e.referenceId;t(n.selectedSystemIds,r,s,o),a()}},{key:"cancelSelection",value:function(){(0,this.props.toggleAddSystemModal)()}},{key:"changeActiveTab",value:function(e,t){(0,this.props.selectActiveTab)(t)}},{key:"render",value:function(){var e,t=this.props,n=t.activeTab,r=t.addSystemModalOpened,a=t.baselineTableData,s=t.globalFilterState,o=t.handleBaselineSelection,i=t.handleHSPSelection,c=t.hasBaselinesReadPermissions,l=t.hasBaselinesWritePermissions,u=t.hasInventoryReadPermissions,d=t.hasHSPReadPermissions,p=t.historicalProfiles,m=t.loading,h=t.entities,y=t.selectEntity,S=t.selectHistoricProfiles,g=t.selectedBaselineIds,b=t.selectedBaselineContent,I=t.selectedHSPContent,E=t.selectedHSPIds,F=t.selectBaseline,P=t.selectedSystemContent,C=t.selectedSystemIds,R=t.setSelectedSystemIds,k=t.totalBaselines,w=this.state,x=w.columns,B=w.basketIsVisible;return f().createElement(f().Fragment,null,f().createElement(v.Modal,{className:"drift",width:"950px",title:"Add to comparison",ouiaId:"add-to-comparison-modal",isOpen:r,onClose:this.cancelSelection,actions:[f().createElement(v.Button,{key:"confirm",variant:"primary",onClick:this.confirmModal,isDisabled:0===(null==h||null===(e=h.selectedSystemIds)||void 0===e?void 0:e.length)&&0===g.length&&0===E.length||B,ouiaId:"add-to-comparison-submit-button"},"Submit"),f().createElement(v.Button,{key:"cancel",variant:"link",onClick:this.cancelSelection,isDisabled:B,ouiaId:"add-to-comparison-cancel-button"},"Cancel")]},f().createElement(O.Z,{globalFilterState:s}),f().createElement(v.Toolbar,{style:{padding:"0px"}},f().createElement(v.ToolbarContent,null,f().createElement(v.ToolbarItem,{variant:"pagination"},f().createElement(Y,{entities:h,handleBaselineSelection:o,handleHSPSelection:i,isVisible:B,selectBaseline:F,selectedBaselineContent:b,selectedHSPContent:I,selectedSystemContent:P,selectEntity:y,selectHistoricProfiles:S,toggleBasketVisible:this.toggleBasketVisible})))),f().createElement(v.Tabs,{activeKey:n,onSelect:this.changeActiveTab},f().createElement(v.Tab,{eventKey:0,title:"Systems",id:"systems-tab","data-ouia-component-id":"systems-tab-button"},f().createElement(Z.Z,{selectedSystemIds:C,hasHistoricalDropdown:d,historicalProfiles:p,hasMultiSelect:!0,hasInventoryReadPermissions:u,entities:h,selectVariant:"checkbox",onSystemSelect:R})),f().createElement(v.Tab,{eventKey:1,title:"Baselines",id:"baselines-tab","data-ouia-component-id":"baselines-tab-button"},f().createElement(D.Z,{tableId:"COMPARISON",hasMultiSelect:!0,onSelect:this.onSelect,tableData:a,loading:m,columns:x,onBulkSelect:this.onBulkSelect,selectedBaselineIds:g,totalBaselines:k,hasReadPermissions:c,hasWritePermissions:l,kebab:!1,basketIsVisible:B})))))}}]),p}(d.Component);W.propTypes={showModal:m().bool,addSystemModalOpened:m().bool,activeTab:m().number,confirmModal:m().func,cancelSelection:m().func,toggleAddSystemModal:m().func,selectActiveTab:m().func,entities:m().object,systems:m().array,selectedBaselineIds:m().array,baselines:m().array,selectedHSPIds:m().array,loading:m().bool,baselineTableData:m().array,selectBaseline:m().func,historicalProfiles:m().array,referenceId:m().string,totalBaselines:m().number,hasInventoryReadPermissions:m().bool,hasBaselinesReadPermissions:m().bool,hasBaselinesWritePermissions:m().bool,hasHSPReadPermissions:m().bool,globalFilterState:m().object,selectedSystemIds:m().array,setSelectedSystemIds:m().func,selectHistoricProfiles:m().func,updateColumns:m().func,selectedSystemContent:m().array,selectedBaselineContent:m().array,selectedHSPContent:m().array,handleSystemSelection:m().func,handleBaselineSelection:m().func,handleHSPSelection:m().func,selectEntity:m().func,disableSystemTable:m().func};const K=(0,y.connect)((function(e){return{addSystemModalOpened:e.addSystemModalState.addSystemModalOpened,systems:e.compareState.systems,activeTab:e.addSystemModalState.activeTab,entities:e.entities,selectedBaselineIds:e.baselinesTableState.comparisonTable.selectedBaselineIds,baselines:e.compareState.baselines,selectedHSPIds:e.historicProfilesState.selectedHSPIds,loading:e.baselinesTableState.comparisonTable.loading,baselineTableData:e.baselinesTableState.comparisonTable.baselineTableData,historicalProfiles:e.compareState.historicalProfiles,totalBaselines:e.baselinesTableState.checkboxTable.totalBaselines,globalFilterState:e.globalFilterState,selectedHSPContent:e.addSystemModalState.selectedHSPContent,selectedBaselineContent:e.addSystemModalState.selectedBaselineContent,selectedSystemContent:e.addSystemModalState.selectedSystemContent}}),(function(e){return{toggleAddSystemModal:function(){return e(I.x.toggleAddSystemModal())},selectActiveTab:function(t){return e(I.x.selectActiveTab(t))},handleSystemSelection:function(t,n){return e(I.x.handleSystemSelection(t,n))},handleBaselineSelection:function(t,n){return e(I.x.handleBaselineSelection(t,n))},handleHSPSelection:function(t){return e(I.x.handleHSPSelection(t))},selectBaseline:function(t,n,r){return e(b.w.selectBaseline(t,n,r))},selectHistoricProfiles:function(t){return e(F.h.selectHistoricProfiles(t))},selectEntity:function(t,n){return e({type:"SELECT_ENTITY",payload:{id:t,isSelected:n}})},setSelectedSystemIds:function(t){return e(I.x.setSelectedSystemIds(t))},disableSystemTable:function(t){return e(U.Z.disableSystemTable(t))},updateColumns:function(t){return e(U.Z.updateColumns(t))}}}))(W);var G=function(e){(0,o.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var a=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function l(e){return(0,a.Z)(this,l),r.call(this,e)}return(0,s.Z)(l,[{key:"icon",value:function(){return"SAME"===this.props.fact.state?f().createElement(g.CheckCircleIcon,{color:"#3E8635",height:"16px",width:"16px"}):"DIFFERENT"===this.props.fact.state?f().createElement(g.ExclamationCircleIcon,{color:"#C9190B",height:"16px",width:"16px"}):f().createElement(g.QuestionCircleIcon,{color:"#151515",height:"16px",width:"16px"})}},{key:"render",value:function(){var e=this.props,t=e.fact,n=e.stateSort;return f().createElement(v.Tooltip,{key:t.name+"-"+n,position:"top",content:f().createElement("div",null,t.tooltip)},this.icon())}}]),l}(d.Component);G.propTypes={fact:m().object,stateSort:m().string};const z=G;var q=n(61119);var Q=function(e){(0,o.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var a=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function l(e){var t;return(0,a.Z)(this,l),(t=r.call(this,e)).state={isReference:t.props.isReference},t}return(0,s.Z)(l,[{key:"renderIcon",value:function(){var e=this.props,t=e.updateReferenceId,n=e.item;return this.state.isReference?f().createElement(g.StarIcon,{className:"reference-selector pointer","data-ouia-component-type":"PF4/Button","data-ouia-component-id":"reference-selector-"+n.id,onClick:function(){return t()}}):f().createElement(g.OutlinedStarIcon,{className:"reference-selector pointer","data-ouia-component-type":"PF4/Button","data-ouia-component-id":"reference-selector-"+n.id,onClick:function(){return t(n.id)}})}},{key:"renderMessage",value:function(){var e=this.state.isReference,t=this.props.item,n=t.type;return"historical-system-profile"===t.type&&(n="historical system"),e?f().createElement("div",null,"This is the reference the other items are being compared against."):f().createElement("div",null,"Use this ",n," as a reference to compare.")}},{key:"render",value:function(){return f().createElement(v.Tooltip,{position:"top",content:this.renderMessage()},this.renderIcon())}}]),l}(d.Component);Q.propTypes={isReference:m().bool,updateReferenceId:m().func,item:m().object};const J=Q;var X=function(e){(0,o.Z)(p,e);var t,n,l,d=(n=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(n);if(l){var r=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,i.Z)(this,e)});function p(e){var t;return(0,a.Z)(this,p),(t=d.call(this,e)).formatDate=function(e){return N().utc(e).format("DD MMM YYYY, HH:mm UTC")},t}return(0,s.Z)(p,[{key:"renderSortButton",value:function(e){return e===R.aW?f().createElement(g.LongArrowAltUpIcon,{className:"active-blue"}):e===R.jo?f().createElement(g.LongArrowAltDownIcon,{className:"active-blue"}):f().createElement(g.ArrowsAltVIcon,{className:"not-active"})}},{key:"toggleSort",value:(t=(0,r.Z)(u().mark((function e(t,n){var r,a,s,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props,a=r.setHistory,s=r.toggleFactSort,o=r.toggleStateSort,"fact"!==t){e.next=6;break}return e.next=4,s(n);case 4:e.next=8;break;case 6:return e.next=8,o(n);case 8:a();case 9:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"renderSystemHeaders",value:function(){var e=this,t=this.props,n=t.fetchCompare,r=t.hasHSPReadPermissions,a=t.masterList,s=t.referenceId,o=t.removeSystem,i=t.selectedBaselineIds,c=t.selectedHSPIds,l=t.selectHistoricProfiles,u=t.systemIds,d=t.updateReferenceId,p=[],m="";return a.forEach((function(t){"system"===t.type?m=f().createElement(v.Tooltip,{position:"top",content:f().createElement("div",null,"System")},f().createElement(g.ServerIcon,null)):"baseline"===t.type?m=f().createElement(v.Tooltip,{position:"top",content:f().createElement("div",null,"Baseline")},f().createElement(g.BlueprintIcon,null)):"historical-system-profile"===t.type&&(m=f().createElement(v.Tooltip,{position:"top",content:f().createElement("div",null,"Historical system")},f().createElement(g.ClockIcon,null))),p.push(f().createElement("th",{"header-id":t.id,key:t.id,className:t.id===s?"drift-header reference-header":"drift-header ".concat(t.type,"-header")},f().createElement("div",null,f().createElement("a",{onClick:function(){return o(t)},className:"remove-system-icon","data-ouia-component-type":"PF4/Button","data-ouia-component-id":"remove-system-button-"+t.id},f().createElement(g.TimesIcon,null))),f().createElement("div",{className:"comparison-header"},f().createElement("div",{className:"drift-header-icon"},m),f().createElement("div",{className:"system-name"},t.display_name),f().createElement("div",{className:"system-updated-and-reference"},f().createElement(J,{updateReferenceId:d,item:t,isReference:t.id===s}),!1===t.system_profile_exists?f().createElement(v.Tooltip,{position:"top",content:f().createElement("div",null,"System profile does not exist. Please run insights-client on system to upload archive.")},f().createElement(g.ExclamationTriangleIcon,{color:"#f0ab00"})):"",t.last_updated?e.formatDate(t.last_updated):e.formatDate(t.updated),!r||"system"!==t.type&&"historical-system-profile"!==t.type?null:f().createElement(q.Z,{system:t,systemIds:u,systemName:t.display_name,referenceId:s,fetchCompare:n,hasCompareButton:!0,hasMultiSelect:!0,selectedHSPIds:c,selectHistoricProfiles:l,selectedBaselineIds:i})))))})),p}},{key:"renderHeaderRow",value:function(){var e=this,t=this.props,n=t.factSort,r=t.stateSort;return f().createElement("tr",{className:"sticky-column-header","data-ouia-component-type":"PF4/TableRow","data-ouia-component-id":"comparison-table-header-row"},f().createElement("th",{className:"fact-header sticky-column fixed-column-1 pointer",key:"fact-header",id:n,onClick:function(){return e.toggleSort("fact",n)},"data-ouia-component-type":"PF4/Button","data-ouia-component-id":"fact-sort-button"},f().createElement("div",{className:"active-blue"},"Fact ",this.renderSortButton(n))),f().createElement("th",{className:"state-header sticky-column fixed-column-2 pointer",key:"state-header",id:r||"disabled","data-ouia-component-type":"PF4/Button","data-ouia-component-id":"state-sort-button",onClick:function(){return e.toggleSort("state",r)}},""!==r?f().createElement("div",{className:"active-blue"},"State ",this.renderSortButton(r)):f().createElement("div",null,"State ",this.renderSortButton(r))),this.renderSystemHeaders())}},{key:"render",value:function(){return f().createElement(f().Fragment,null,this.renderHeaderRow())}}]),p}(d.Component);X.propTypes={factSort:m().string,fetchCompare:m().func,hasHSPReadPermissions:m().bool,masterList:m().array,referenceId:m().string,removeSystem:m().func,stateSort:m().string,systemIds:m().array,toggleFactSort:m().func,toggleStateSort:m().func,updateReferenceId:m().func,setHistory:m().func,selectedHSPIds:m().array,selectHistoricProfiles:m().func,selectedBaselineIds:m().array};const $=X;function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var te=function(e){(0,o.Z)(y,e);var t,n,l,d,p,m,h=(p=y,m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(p);if(m){var n=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,i.Z)(this,e)});function y(e){var t;return(0,a.Z)(this,y),(t=h.call(this,e)).shiftReferenceToFront=function(e){var n,r;return n=e.findIndex((function(e){return e.id===t.props.referenceId})),r=e.splice(n,1),e.unshift(r[0]),e},t.updateReferenceId=function(e){t.fetchCompare(t.systemIds,t.baselineIds,t.HSPIds,e)},t.findHSPReference=function(){var e=t.props.referenceId,n=e;return t.HSPIds.forEach((function(t){t===e&&(n=void 0)})),n},t.state={emptyStateMessage:["You currently have no system or baselines displayed. Add at least two","systems or baselines to compare their facts."]},t.masterList=[],t.setSystemIds(),t.setBaselineIds(),t.setHSPIds(),t.setReferenceId(),t.setFilters(),t.setSort(),t.fetchCompare=t.fetchCompare.bind((0,B.Z)(t)),t.removeSystem=t.removeSystem.bind((0,B.Z)(t)),t}return(0,s.Z)(y,[{key:"componentDidMount",value:(d=(0,r.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:(this.systemIds.length>0||this.baselineIds.length>0||this.HSPIds.length>0)&&this.fetchCompare(this.systemIds,this.baselineIds,this.HSPIds,this.props.referenceId);case 3:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"shouldComponentUpdate",value:(l=(0,r.Z)(u().mark((function e(t){var n,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.emptyState){e.next=3;break}return e.next=3,null===(n=window.insights)||void 0===n||null===(r=n.chrome)||void 0===r||null===(a=r.appAction)||void 0===a?void 0:a.call(r,"comparison-view");case 3:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"formatEntities",value:function(e,t,n){var r,a=[],s={};if(0===e.length&&0===t.length&&0===n.length)return[];e=e.map((function(e){return e.type="system",e})),t=t.map((function(e){return e.type="baseline",e})),(n=n.map((function(e){return e.type="historical-system-profile",e}))).forEach((function(e){Object.prototype.hasOwnProperty.call(s,e.system_id)?s[e.system_id].push(e):s[e.system_id]=[e]})),a=e;for(var o=function(){var t=(0,x.Z)(c[i],2),n=t[0],r=t[1],s=e.find((function(e){return n===e.id})),o=void 0;void 0!==s?(o=a.indexOf(s),a=[].concat((0,P.Z)(a.slice(0,o+1)),(0,P.Z)(r),(0,P.Z)(a.slice(o+1,a.length)))):a=a.concat(r)},i=0,c=Object.entries(s);i<c.length;i++)o();return r=t.concat(a),this.props.referenceId&&(r=this.shiftReferenceToFront(r)),r}},{key:"setSystemIds",value:function(){var e=new URLSearchParams(this.props.location.search);this.systemIds=e.getAll("system_ids"),this.systemIds.length?(this.systemIds=Array.isArray(this.systemIds)?this.systemIds:[this.systemIds],this.systemIds=this.systemIds.filter((function(e){return void 0!==e}))):this.systemIds=this.props.systems.map((function(e){return e.id}))}},{key:"setBaselineIds",value:function(){var e=new URLSearchParams(this.props.location.search);this.baselineIds=e.getAll("baseline_ids"),this.baselineIds.length?(this.baselineIds=Array.isArray(this.baselineIds)?this.baselineIds:[this.baselineIds],this.baselineIds=this.baselineIds.filter((function(e){return void 0!==e})),this.props.setSelectedBaselines(this.baselineIds,"COMPARISON")):this.baselineIds=this.props.baselines.map((function(e){return e.id}))}},{key:"setHSPIds",value:function(){var e=this.props,t=e.location,n=e.selectHistoricProfiles,r=new URLSearchParams(t.search);this.HSPIds=r.getAll("hsp_ids"),this.HSPIds.length?(this.HSPIds=Array.isArray(this.HSPIds)?this.HSPIds:[this.HSPIds],this.HSPIds=this.HSPIds.filter((function(e){return void 0!==e})),n(this.HSPIds)):this.HSPIds=this.props.historicalProfiles.map((function(e){return e.id}))}},{key:"setReferenceId",value:function(){var e=this.props,t=e.location,n=e.updateReferenceId,r=new URLSearchParams(t.search).get("reference_id");r&&n(null===r?void 0:r)}},{key:"setFilters",value:function(){var e,t,n=this.props,r=n.addStateFilter,a=n.handleFactFilter,s=n.location,o=n.stateFilters,i=new URLSearchParams(s.search);null===(e=i.get("filter[name]"))||void 0===e||e.split(",").forEach((function(e){a(e)}));var c=null===(t=i.get("filter[state]"))||void 0===t?void 0:t.split(",");(null==c?void 0:c.length)>0&&o.forEach((function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,w.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);null!=c&&c.includes(e.filter.toLowerCase())&&(t.selected=!1),r(t)}))}},{key:"setSort",value:function(){var e,t,n=this.props,r=n.location,a=n.toggleFactSort,s=n.toggleStateSort,o=null===(e=new URLSearchParams(r.search).get("sort"))||void 0===e?void 0:e.split(",");null==o||o.forEach((function(e){e.includes("fact")?"-"===e[0]?a(R.aW):a(R.jo):"-"===e[0]?s(R.aW):"state"===e&&s("")})),1===(null==o?void 0:o.length)&&null!==(t=o[0])&&void 0!==t&&t.includes("fact")&&s(R.jo)}},{key:"removeSystem",value:(n=(0,r.Z)(u().mark((function e(t){var n,r,a,s,o,i,c,l,d,f,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.handleBaselineSelection,a=n.handleHSPSelection,s=n.handleSystemSelection,o=n.historicalProfiles,i=n.isFirstReference,c=n.referenceId,l=n.selectHistoricProfiles,d=n.setIsFirstReference,f=c,"system"!==t.type){e.next=15;break}return this.systemIds=this.systemIds.filter((function(e){return e!==t.id})),e.next=6,this.findHSPReference();case 6:return f=e.sent,s([t],!1),p=o.filter((function(e){return e.system_id===t.id})),e.next=11,o.filter((function(e){return e.system_id!==t.id})).map((function(e){return e.id}));case 11:this.HSPIds=e.sent,p.forEach((function(e){a(e)})),e.next=16;break;case 15:"baseline"===t.type?(this.baselineIds=this.baselineIds.filter((function(e){return e!==t.id})),r([t],!1)):"historical-system-profile"===t.type&&(this.HSPIds=this.HSPIds.filter((function(e){return e!==t.id})),a(t));case 16:t.id===f&&(f=void 0),l(this.HSPIds),this.systemIds.length||this.baselineIds.length||this.HSPIds.length||c||i||d(!0),this.fetchCompare(this.systemIds,this.baselineIds,this.HSPIds,f);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchCompare",value:(t=(0,r.Z)(u().mark((function e(){var t,n,r,a,s,o,i,c,l,d,f,p,m,h=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:[],n=h.length>1?h[1]:void 0,r=h.length>2?h[2]:void 0,a=h.length>3?h[3]:void 0,s=this.props,o=s.clearComparison,i=s.fetchCompare,c=s.isFirstReference,l=s.setHistory,d=s.setIsFirstReference,f=s.setSelectedBaselines,p=s.updateReferenceId,this.systemIds=t,this.baselineIds=n,this.HSPIds=r,c?!a&&this.baselineIds.length?m=n[0]:a&&(m=a):m=a,f(this.baselineIds,"COMPARISON"),p(m),!(t.length||n.length||r.length||m)){e.next=18;break}return e.next=14,i(t,n,r,m);case 14:return e.next=16,d(!1);case 16:e.next=20;break;case 18:return e.next=20,o();case 20:l();case 21:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"renderRows",value:function(e){var t=this,n=[];return void 0!==e&&e.forEach((function(e){n.push(t.renderRow(e))})),n}},{key:"renderLoadingRows",value:function(){for(var e=[],t=[],n=0;n<3;n+=1)t.push(f().createElement("td",null,f().createElement(S.Skeleton,{size:S.SkeletonSize.md})));for(var r=0;r<10;r+=1)e.push(f().createElement("tr",null,t));return e}},{key:"findSystem",value:function(e){var t,n=this,r=[],a=void 0;return this.masterList.forEach((function(s){var o,i,c,l,u;t=["comparison-cell"],a=e.systems.find((function(e){return e.id===s.id})),n.props.referenceId?null!==(l=a)&&void 0!==l&&l.is_obfuscated?t.push("obfuscated"):"DIFFERENT"===a.state&&(t.push("highlight"),t.push("different-fact-cell")):null!==(u=a)&&void 0!==u&&u.is_obfuscated?t.push("obfuscated"):"DIFFERENT"===e.state&&t.push("highlight"),r.push(f().createElement("td",{className:t.join(" ")},null===(null===(o=a)||void 0===o?void 0:o.value)?"No Data":null===(i=a)||void 0===i?void 0:i.value,null!==(c=a)&&void 0!==c&&c.is_obfuscated?f().createElement("span",{style:{float:"right"}},f().createElement(v.Tooltip,{position:"top",content:f().createElement("div",null,"This data has been redacted from the insights-client upload.")},f().createElement(g.LockIcon,{color:"#737679"}))):""))})),r}},{key:"renderFact",value:function(e,t,n){var r=this.props.expandedRows;return f().createElement("td",{className:t},this.renderExpandableRowButton(r,e,n)," ",e)}},{key:"renderState",value:function(e,t){var n=this.props.stateSort;return f().createElement("td",{className:t},f().createElement(z,{fact:e,stateSort:n||null}))}},{key:"renderRow",value:function(e){var t=this,n=this.props,r=n.expandedRows,a=n.stateSort,s=[],o=[];return e.comparisons?(s.push(this.renderFact(e.name,r.includes(e.name)?"nested-fact sticky-column fixed-column-1":"sticky-column fixed-column-1")),s.push(this.renderState(e,"fact-state sticky-column fixed-column-2")),this.masterList.forEach((function(){s.push(f().createElement("td",{className:"comparison-cell"}))})),o.push(f().createElement("tr",{"data-ouia-component-type":"PF4/TableRow","data-ouia-component-id":"comparison-table-row-"+e.name},s)),r.includes(e.name)&&e.comparisons.forEach((function(n){s=t.renderRowChild(n),o.push(f().createElement("tr",{"data-ouia-component-type":"PF4/TableRow","data-ouia-component-id":"comparison-table-row-"+n.name,category:e.name,className:"DIFFERENT"===n.state?"unexpected-row":""},s)),n.multivalues&&r.includes(n.name)&&n.multivalues.forEach((function(e){s=t.renderRowChild(e);var r=e.systems.filter((function(e){return""!==e.value}))[0].value;o.push(f().createElement("tr",{className:"DIFFERENT"===e.state?"unexpected-row":"","data-ouia-component-type":"PF4/TableRow","data-ouia-component-id":"comparison-table-row-multivalue-"+n.name+"-"+r},s))}))}))):(s.push(f().createElement("td",{className:"sticky-column fixed-column-1"},e.name)),s.push(f().createElement("td",{className:"fact-state sticky-column fixed-column-2"},f().createElement(z,{fact:e,stateSort:a}))),s=s.concat(this.findSystem(e)),o.push(f().createElement("tr",{"data-ouia-component-type":"PF4/TableRow","data-ouia-component-id":"comparison-table-row-"+e.name,className:"DIFFERENT"===e.state?"unexpected-row":""},s))),o}},{key:"renderRowChild",value:function(e){var t=this.props.expandedRows,n=[];return e.multivalues?(n.push(this.renderFact(e.name,t.includes(e.name)?"nested-fact sticky-column fixed-column-1":"sticky-column fixed-column-1",!0)),n.push(this.renderState(e,"fact-state sticky-column fixed-column-2")),this.masterList.forEach((function(){n.push(f().createElement("td",{className:"comparison-cell"}))}))):(n.push(f().createElement("td",{className:"nested-fact sticky-column fixed-column-1"},f().createElement("p",{className:"child-row"},e.name))),n.push(f().createElement("td",{className:"fact-state sticky-column fixed-column-2"},f().createElement(z,{fact:e}))),n=n.concat(this.findSystem(e))),n}},{key:"renderExpandableRowButton",value:function(e,t,n){var r=this;return e.includes(t)?f().createElement(g.AngleDownIcon,{className:"carat-margin pointer active-blue"+(n?" child-row":null),"data-ouia-component-type":"PF4/Button","data-ouia-component-id":"expand-category-button-"+t,onClick:function(){return r.props.expandRow(t)}}):f().createElement(g.AngleRightIcon,{className:"carat-margin pointer"+(n?" child-row":null),"data-ouia-component-type":"PF4/Button","data-ouia-component-id":"expand-category-button-"+t,onClick:function(){return r.props.expandRow(t)}})}},{key:"renderTable",value:function(e,t){var n=this.props,r=n.factSort,a=n.hasHSPReadPermissions,s=n.referenceId,o=n.selectedBaselineIds,i=n.selectedHSPIds,c=n.selectHistoricProfiles,l=n.setHistory,u=n.stateSort,d=n.toggleFactSort,p=n.toggleStateSort;return f().createElement(f().Fragment,null,f().createElement("div",{className:"drift-table-wrapper"},f().createElement("table",{className:"pf-c-table pf-m-compact drift-table","data-ouia-component-type":"PF4/Table","data-ouia-component-id":"comparison-table"},f().createElement("thead",null,f().createElement($,{factSort:r,fetchCompare:this.fetchCompare,hasHSPReadPermissions:a,masterList:this.masterList,referenceId:s,removeSystem:this.removeSystem,stateSort:u,systemIds:this.systemIds,toggleFactSort:d,toggleStateSort:p,updateReferenceId:this.updateReferenceId,setHistory:l,selectedHSPIds:i,selectHistoricProfiles:c,selectedBaselineIds:o})),f().createElement("tbody",null,t?this.renderLoadingRows():this.renderRows(e)))))}},{key:"render",value:function(){var e=this.props,t=e.emptyState,n=e.filteredCompareData,r=e.systems,a=e.baselines,s=e.hasBaselinesReadPermissions,o=e.hasBaselinesWritePermissions,i=e.hasHSPReadPermissions,c=e.hasInventoryReadPermissions,l=e.historicalProfiles,u=e.loading;return this.masterList=this.formatEntities(r,a,l),f().createElement(f().Fragment,null,f().createElement(K,{selectedSystemIds:r.map((function(e){return e.id})),confirmModal:this.fetchCompare,referenceId:this.props.referenceId,hasInventoryReadPermissions:c,hasBaselinesReadPermissions:s,hasBaselinesWritePermissions:o,hasHSPReadPermissions:i}),t?null:this.renderTable(n,u))}}]),y}(d.Component);te.propTypes={addSystemModalOpened:m().bool,location:m().object,history:m().object,fetchCompare:m().func,fullCompareData:m().array,filteredCompareData:m().array,systems:m().array,baselines:m().array,historicalProfiles:m().array,factSort:m().string,stateSort:m().string,loading:m().bool,toggleFactSort:m().func,toggleStateSort:m().func,expandRow:m().func,expandedRows:m().array,setSelectedBaselines:m().func,selectHistoricProfiles:m().func,emptyState:m().bool,updateReferenceId:m().func,referenceId:m().string,error:m().object,isFirstReference:m().bool,setIsFirstReference:m().func,clearComparison:m().func,hasInventoryReadPermissions:m().bool,hasBaselinesReadPermissions:m().bool,hasBaselinesWritePermissions:m().bool,stateFilters:m().array,addStateFilter:m().func,handleFactFilter:m().func,activeFactFilters:m().array,factFilter:m().string,setHistory:m().func,selectedHSPIds:m().array,selectedBaselineIds:m().array,handleBaselineSelection:m().func,handleHSPSelection:m().func,handleSystemSelection:m().func,hasHSPReadPermissions:m().bool};const ne=(0,h.withRouter)((0,y.connect)((function(e){return{addSystemModalOpened:e.addSystemModalState.addSystemModalOpened,fullCompareData:e.compareState.fullCompareData,filteredCompareData:e.compareState.filteredCompareData,loading:e.compareState.loading,expandedRows:e.compareState.expandedRows,emptyState:e.compareState.emptyState}}),(function(e){return{fetchCompare:function(t,n,r,a){return e(E.r.fetchCompare(t,n,r,a))},toggleFactSort:function(t){return e(E.r.toggleFactSort(t))},toggleStateSort:function(t){return e(E.r.toggleStateSort(t))},expandRow:function(t){return e(E.r.expandRow(t))},setSelectedBaselines:function(t,n){return e(b.w.setSelectedBaselines(t,n))},selectHistoricProfiles:function(t){return e(F.h.selectHistoricProfiles(t))}}}))(te));var re=n(23419),ae=n(93187);var se=function(e){(0,o.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var a=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function l(e){return(0,a.Z)(this,l),r.call(this,e)}return(0,s.Z)(l,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.toggleAddSystemModal,r=e.isTable;return f().createElement(v.Button,{variant:"primary",onClick:n,isDisabled:!!t,ouiaId:r?"add-to-comparison":"add-to-comparison-empty"},r?"Add":"Add to comparison")}}]),l}(d.Component);se.propTypes={toggleAddSystemModal:m().func,isTable:m().bool,loading:m().bool};const oe=(0,y.connect)(null,(function(e){return{toggleAddSystemModal:function(){return e(I.x.toggleAddSystemModal())}}}))(se);var ie=n(18211);const ce=function(){return{type:ie.Z.OPEN_FILTER_DROPDOWN}};var le=function(e){(0,o.Z)(d,e);var t,n,l=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var a=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function d(e){var t;return(0,a.Z)(this,d),(t=l.call(this,e)).addStateFilter=function(){var e=(0,r.Z)(u().mark((function e(n){var r,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props,a=r.addStateFilter,s=r.setHistory,e.next=3,a(n);case 3:s();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.onToggle=t.onToggle.bind((0,B.Z)(t)),t.createDropdownItem=t.createDropdownItem.bind((0,B.Z)(t)),t}return(0,s.Z)(d,[{key:"onToggle",value:function(){this.props.toggleDropDown()}},{key:"createDropdownItem",value:function(e){var t=this;return f().createElement(v.DropdownItem,{"data-ouia-component-id":"state-filter-option-"+e.display},f().createElement(v.Checkbox,{id:e.display,"data-ouia-component-type":"PF4/Checkbox","data-ouia-component-id":"state-filter-option-checkbox-"+e.display,label:e.display,isChecked:e.selected,onChange:function(){return t.addStateFilter(e)}}))}},{key:"createDropdownArray",value:function(e){var t=[];return e.forEach(function(e){var n=this.createDropdownItem(e);t.push(n)}.bind(this)),t}},{key:"createSelectedViewsString",value:function(e){for(var t=[],n="",r=0;r<e.length;r++)e[r].selected&&t.push(e[r].display);for(var a=0;a<t.length;a++)n+=t[a],a+1<t.length&&(n+=", ");return n}},{key:"render",value:function(){var e,t,n=this.props.stateFilters;return e=this.createDropdownArray(n),t=this.createSelectedViewsString(n),f().createElement(f().Fragment,null,f().createElement(v.Dropdown,{ouiaId:"state-filter-dropdown",toggle:f().createElement(v.DropdownToggle,{onToggle:this.onToggle,ouiaId:"state-filter-dropdown-toggle"},"View: ",t),isOpen:this.props.filterDropdownOpened,dropdownItems:e}))}}]),d}(d.Component);le.propTypes={toggleDropDown:m().func,filterDropdownOpened:m().bool,stateFilters:m().array,addStateFilter:m().func,setHistory:m().func};const ue=(0,y.connect)((function(e){return{filterDropdownOpened:e.filterDropdownOpened,stateFilters:e.compareState.stateFilters}}),(function(e){return{toggleDropDown:function(){return e(ce())},addStateFilter:function(t){return e(E.r.addStateFilter(t))}}}))(le);var de=n(23279),fe=n.n(de);var pe=function(e){(0,o.Z)(p,e);var t,n,l,d=(n=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(n);if(l){var r=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,i.Z)(this,e)});function p(e){var t;return(0,a.Z)(this,p),(t=d.call(this,e)).updateFactFilter=function(e){t.setState({filter:e}),t.setFactFilter(e)},t.setFactFilter=fe()(function(){var e=(0,r.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.filterByFact(t);case 2:this.props.setHistory();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),250),t.checkKeyPress=function(e){var n=t.props.activeFactFilters,r=t.state.filter;"Enter"===e.key&&(e.preventDefault(),n.includes(r)||t.addToActiveFactFilters(r))},t.state={filter:t.props.factFilter},t.setFactFilter=t.setFactFilter.bind((0,B.Z)(t)),t}return(0,s.Z)(p,[{key:"componentDidUpdate",value:function(e){""!==e.factFilter&&""===this.props.factFilter&&this.setState({filter:this.props.factFilter})}},{key:"addToActiveFactFilters",value:(t=(0,r.Z)(u().mark((function e(t){var n,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,r=n.handleFactFilter,a=n.setHistory,e.next=3,r(t);case 3:a();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){return f().createElement(f().Fragment,null,f().createElement(v.Form,null,f().createElement(v.FormGroup,{isRequired:!0,type:"text",fieldId:"filter",onKeyPress:this.checkKeyPress},f().createElement(v.TextInput,{value:this.state.filter,id:"filterByFact",placeholder:"Filter by fact",onChange:this.updateFactFilter,"aria-label":"filter by fact","data-ouia-component-type":"PF4/TextInput","data-ouia-component-id":"fact-filter-input-comparison"}))))}}]),p}(d.Component);pe.propTypes={filterByFact:m().func,factFilter:m().string,handleFactFilter:m().func,activeFactFilters:m().array,setHistory:m().func};const me=pe;var he=n(43895),ye=n(74381);var Se=function(e){(0,o.Z)(p,e);var t,n,l,d=(n=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(n);if(l){var r=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,i.Z)(this,e)});function p(e){var t;return(0,a.Z)(this,p),(t=d.call(this,e)).setFactFilterChips=function(){var e=t.props,n=e.activeFactFilters,r=e.factFilter,a=(0,P.Z)(n);return r.length&&!n.includes(r)&&a.push(r),a},t.setStateChips=function(e){var t=[];return e.forEach((function(e){e.selected&&t.push(e.display)})),t},t.clearAllStateChips=(0,r.Z)(u().mark((function e(){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.props,r=n.addStateFilter,n.stateFilters.forEach((function(e){e.selected=!0,r(e)}));case 2:case"end":return e.stop()}}),e)}))),t.removeChip=(0,r.Z)(u().mark((function e(){var n,a,s,o,i,c,l,d,f,p,m=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.length>0&&void 0!==m[0]?m[0]:"",a=m.length>1&&void 0!==m[1]?m[1]:"",s=t.props,o=s.activeFactFilters,i=s.addStateFilter,c=s.clearAllFactFilters,l=s.filterByFact,d=s.handleFactFilter,f=s.setHistory,p=s.stateFilters,!n){e.next=22;break}if("State"!==n){e.next=8;break}""===a?t.clearAllStateChips():p.forEach(function(){var e=(0,r.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.display!==a){e.next=3;break}return e.next=3,i(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=20;break;case 8:if(""!==a){e.next=13;break}return e.next=11,c();case 11:e.next=20;break;case 13:if(!o.includes(a)){e.next=18;break}return e.next=16,d(a);case 16:e.next=20;break;case 18:return e.next=20,l("");case 20:e.next=26;break;case 22:return e.next=24,t.clearAllStateChips();case 24:return e.next=26,t.clearAllFactChips();case 26:f();case 27:case"end":return e.stop()}}),e)}))),t.setIsEmpty=function(e){t.setState({isEmpty:e})},t.onToggle=function(){var e=t.state.dropdownOpen;t.setState({dropdownOpen:!e})},t.clearFilters=(0,r.Z)(u().mark((function e(){var n,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,r=n.clearComparisonFilters,a=n.setHistory,e.next=3,r();case 3:a();case 4:case"end":return e.stop()}}),e)}))),t.clearComparison=(0,r.Z)(u().mark((function e(){var n,r,a,s,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,r=n.clearComparison,a=n.clearSelectedBaselines,s=n.setHistory,o=n.setIsFirstReference,i=n.updateReferenceId,e.next=3,r();case 3:return e.next=5,a("COMPARISON");case 5:return e.next=7,o(!0);case 7:return e.next=9,i();case 9:s();case 10:case"end":return e.stop()}}),e)}))),t.state={actionKebabItems:[f().createElement(v.DropdownItem,{key:"remove-systems",component:"button","data-ouia-component-id":"clear-all-comparisons-dropdown-item",onClick:t.clearComparison},"Clear all comparisons")],dropdownItems:[f().createElement(v.DropdownItem,{key:"export-to-CSV",component:"button","data-ouia-component-id":"export-to-csv-dropdown-item-comparison",onClick:function(){return t.props.exportToCSV()}},"Export to CSV")],isEmpty:!0,dropdownOpen:!1},t}return(0,s.Z)(p,[{key:"clearAllFactChips",value:(t=(0,r.Z)(u().mark((function e(){var t,n,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.activeFactFilters,r=t.filterByFact,a=t.handleFactFilter,e.next=3,n.forEach((function(e){a(e)}));case 3:r("");case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,t=e.activeFactFilters,n=e.factFilter,r=e.filterByFact,a=e.handleFactFilter,s=e.loading,o=e.page,i=e.perPage,c=e.setHistory,l=e.stateFilters,u=e.totalFacts,d=e.updatePagination,p=this.state,m=p.actionKebabItems,h=p.dropdownItems,y=p.dropdownOpen;return f().createElement(f().Fragment,null,f().createElement(v.Toolbar,{className:"drift-toolbar",clearAllFilters:this.removeChip},f().createElement(v.ToolbarContent,null,f().createElement(v.ToolbarGroup,{variant:"filter-group"},f().createElement(v.ToolbarFilter,{chips:this.setFactFilterChips(),deleteChip:this.removeChip,deleteChipGroup:this.removeChip,categoryName:"Fact name"},f().createElement(me,{factFilter:n,activeFactFilters:t,handleFactFilter:a,filterByFact:r,setHistory:c})),f().createElement(v.ToolbarFilter,{chips:this.setStateChips(l),deleteChip:this.removeChip,deleteChipGroup:this.removeChip,categoryName:"State"},f().createElement(ue,{setHistory:c}))),f().createElement(v.ToolbarGroup,{variant:"button-group"},f().createElement(v.ToolbarItem,null,f().createElement(oe,{loading:s}))),f().createElement(v.ToolbarGroup,{variant:"icon-button-group"},f().createElement(v.ToolbarItem,null,f().createElement(ye.Z,{dropdownItems:h,ouiaId:"export-dropdown-comparison",isOpen:y,onToggle:this.onToggle})),f().createElement(v.ToolbarItem,null,f().createElement(he.Z,{ouiaId:"clear-comparison-dropdown",dropdownItems:m}))),f().createElement(v.ToolbarItem,{variant:"pagination",align:{default:"alignRight"}},f().createElement(ae.v,{page:o,perPage:i,total:u,isCompact:!0,updatePagination:d,widgetId:"drift-pagination-top",ouiaId:"comparison-pagination-top",variant:v.PaginationVariant.top})))))}}]),p}(d.Component);Se.propTypes={loading:m().bool,history:m().object,page:m().number,perPage:m().number,totalFacts:m().number,updatePagination:m().func,clearComparisonFilters:m().func,clearComparison:m().func,exportToCSV:m().func,clearSelectedBaselines:m().func,setIsFirstReference:m().func,updateReferenceId:m().func,factFilter:m().string,filterByFact:m().func,stateFilters:m().array,addStateFilter:m().func,activeFactFilters:m().array,handleFactFilter:m().func,clearAllFactFilters:m().func,setHistory:m().func};const ve=Se;var ge=n(42325),be=n(43946);var Ie=function(e){(0,o.Z)(p,e);var t,n,l,d=(n=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(n);if(l){var r=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,i.Z)(this,e)});function p(e){var t;return(0,a.Z)(this,p),(t=d.call(this,e)).setHistory=function(){var e=t.props,n=e.activeFactFilters,r=e.baselines,a=e.factFilter,s=e.factSort,o=e.historicalProfiles,i=e.history,c=e.referenceId,l=e.stateFilters,u=e.stateSort;k(i,e.systems.map((function(e){return e.id})),r.map((function(e){return e.id})),o.map((function(e){return e.id})),c,n,a,l,s,u)},t.setIsFirstReference=function(e){t.setState({isFirstReference:e})},t.onClose=function(){var e=t.props,n=e.revertCompareData,r=e.history,a=e.previousStateSystems;n(),k(r,a.map((function(e){return e.id})))},t.renderEmptyState=function(){var e=t.state.emptyStateMessage,n=t.props.error;return n.status?f().createElement(ge.Z,{icon:g.ExclamationCircleIcon,color:"#c9190b",title:"Comparison cannot be displayed",text:e,error:"Error "+n.status+": "+n.detail,button:f().createElement(oe,{isTable:!1})}):f().createElement(ge.Z,{icon:g.PlusCircleIcon,color:"#6a6e73",title:"Add systems or baselines to compare",text:e,button:f().createElement(oe,{isTable:!1})})},t.state={emptyStateMessage:["You currently have no system or baselines displayed. Add at least two","systems or baselines to compare their facts."],isFirstReference:!0},t}return(0,s.Z)(p,[{key:"componentDidMount",value:(t=(0,r.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:this.props.loadEntities();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.props,n=t.activeFactFilters,r=t.addStateFilter,a=t.baselines,s=t.clearAllFactFilters,o=t.clearComparison,i=t.clearComparisonFilters,c=t.clearSelectedBaselines,l=t.emptyState,u=t.error,d=t.exportToCSV,p=t.factFilter,m=t.factSort,h=t.filterByFact,y=t.handleFactFilter,b=t.historicalProfiles,I=t.handleBaselineSelection,E=t.handleHSPSelection,F=t.handleSystemSelection,P=t.history,C=t.loading,R=t.page,k=t.perPage,w=t.referenceId,x=t.selectedBaselineIds,B=t.selectedHSPIds,T=t.stateFilters,H=t.stateSort,Z=t.systems,D=t.totalFacts,O=t.updatePagination,A=t.updateReferenceId,N=this.state.isFirstReference;return f().createElement(f().Fragment,null,f().createElement(S.PageHeader,null,f().createElement(S.PageHeaderTitle,{title:"Comparison"})),f().createElement(S.Main,null,f().createElement(be.B.Consumer,null,(function(t){return!1===t.permissions.compareRead?f().createElement(ge.Z,{icon:g.LockIcon,color:"#6a6e73",title:"You do not have access to Drift comparison",text:["Contact your organization administrator(s) for more information."]}):f().createElement(f().Fragment,null,f().createElement(re.Z,{error:u,onClose:e.onClose}),l&&!C?e.renderEmptyState():f().createElement("div",null),f().createElement(v.Card,{className:"pf-t-light pf-m-opaque-100"},f().createElement(v.CardBody,null,f().createElement("div",null,l?null:f().createElement(ve,{loading:C,history:P,page:R,perPage:k,totalFacts:D,updatePagination:O,clearComparison:o,clearComparisonFilters:i,exportToCSV:d,updateReferenceId:A,setIsFirstReference:e.setIsFirstReference,clearSelectedBaselines:c,factFilter:p,filterByFact:h,stateFilters:T,addStateFilter:r,activeFactFilters:n,handleFactFilter:y,clearAllFactFilters:s,setHistory:e.setHistory}),f().createElement(ne,{updateReferenceId:A,error:u,isFirstReference:N,setIsFirstReference:e.setIsFirstReference,clearComparison:o,handleBaselineSelection:I,handleHSPSelection:E,handleSystemSelection:F,hasBaselinesReadPermissions:t.permissions.baselinesRead,hasBaselinesWritePermissions:t.permissions.baselinesWrite,hasInventoryReadPermissions:t.permissions.inventoryRead,hasHSPReadPermissions:t.permissions.hspRead,handleFactFilter:y,addStateFilter:r,stateFilters:T,activeFactFilters:n,factFilter:p,setHistory:e.setHistory,factSort:m,stateSort:H,referenceId:w,systems:Z,baselines:a,historicalProfiles:b,selectedHSPIds:B,selectedBaselineIds:x}),l||C?null:f().createElement(v.Toolbar,{className:"drift-toolbar"},f().createElement(v.ToolbarGroup,{className:"pf-c-pagination"},f().createElement(v.ToolbarItem,null,f().createElement(ae.Z,{page:R,perPage:k,total:D,isCompact:!1,updatePagination:O,widgetId:"drift-pagination-bottom",ouiaId:"drift-pagination-bottom",variant:v.PaginationVariant.bottom}))))))))}))))}}]),p}(d.Component);Ie.propTypes={perPage:m().number,page:m().number,totalFacts:m().number,error:m().object,loading:m().bool,clearSelectedBaselines:m().func,emptyState:m().bool,updatePagination:m().func,updateReferenceId:m().func,clearComparison:m().func,clearComparisonFilters:m().func,history:m().object,location:m().object,selectHistoricProfiles:m().func,selectedHSPIds:m().array,revertCompareData:m().func,previousStateSystems:m().array,exportToCSV:m().func,factFilter:m().string,activeFactFilters:m().array,handleFactFilter:m().func,filterByFact:m().func,stateFilters:m().array,addStateFilter:m().func,clearAllFactFilters:m().func,factSort:m().string,stateSort:m().string,referenceId:m().number,systems:m().array,baselines:m().array,historicalProfiles:m().array,loadEntities:m().func,selectedBaselineIds:m().array,handleBaselineSelection:m().func,handleHSPSelection:m().func,handleSystemSelection:m().func};const Ee=(0,h.withRouter)((0,y.connect)((function(e){return{page:e.compareState.page,perPage:e.compareState.perPage,totalFacts:e.compareState.totalFacts,error:e.compareState.error,loading:e.compareState.loading,emptyState:e.compareState.emptyState,selectedHSPIds:e.historicProfilesState.selectedHSPIds,previousStateSystems:e.compareState.previousStateSystems,factFilter:e.compareState.factFilter,stateFilters:e.compareState.stateFilters,activeFactFilters:e.compareState.activeFactFilters,factSort:e.compareState.factSort,stateSort:e.compareState.stateSort,referenceId:e.compareState.referenceId,systems:e.compareState.systems,baselines:e.compareState.baselines,historicalProfiles:e.compareState.historicalProfiles,selectedBaselineIds:e.baselinesTableState.comparisonTable.selectedBaselineIds}}),(function(e){return{clearSelectedBaselines:function(t){return e(b.w.clearSelectedBaselines(t))},updatePagination:function(t){return e(E.r.updatePagination(t))},updateReferenceId:function(t){return e(E.r.updateReferenceId(t))},clearComparison:function(){return e(E.r.clearComparison())},clearComparisonFilters:function(){return e(E.r.clearComparisonFilters())},selectHistoricProfiles:function(t){return e(F.h.selectHistoricProfiles(t))},revertCompareData:function(){return e(E.r.revertCompareData())},exportToCSV:function(){return e(E.r.exportToCSV())},filterByFact:function(t){return e(E.r.filterByFact(t))},addStateFilter:function(t){return e(E.r.addStateFilter(t))},handleFactFilter:function(t){return e(E.r.handleFactFilter(t))},clearAllFactFilters:function(){return e(E.r.clearAllFactFilters())},loadEntities:function(){return e({type:"LOAD_ENTITIES"})},handleSystemSelection:function(t,n){return e(I.x.handleSystemSelection(t,n))},handleBaselineSelection:function(t,n){return e(I.x.handleBaselineSelection(t,n))},handleHSPSelection:function(t){return e(I.x.handleHSPSelection(t))}}}))(Ie))}}]);
//# sourceMappingURL=../sourcemaps/287.12fd07489ad320b418b7.js.map